{"version":3,"file":"index.es.js","sources":["../src/payconductor/iframe/constants.ts","../src/payconductor/iframe/types.ts","../src/payconductor/constants.ts","../src/payconductor/utils.ts","../src/payconductor/internal.ts","../src/payconductor/payconductor.tsx","../src/payconductor/payconductor-element.tsx","../src/payconductor/hooks/use-payconductor.ts","../src/payconductor/hooks/use-element.ts"],"sourcesContent":["// PayConductor Shared Constants\n// Served statically at iframe.payconductor.ai/constants.ts\n// Used by the iFrame (imported directly) and the SDK Web (synced with: bun sync)\n\nexport const APP_BASE_URL_PROD = \"https://app.payconductor.ai\";\nexport const API_BASE_URL_PROD = \"https://app.payconductor.ai/api/v1\";\nexport const IFRAME_BASE_URL_PROD = \"https://iframe.payconductor.ai/v1\";\nexport const IFRAME_BASE_URL_DEV = \"http://localhost:5175\";\nexport const APP_BASE_URL_DEV = \"http://localhost:3000\";\nexport const DEFAULT_LOCALE = \"pt-BR\";\nexport const REQUEST_TIMEOUT_MS = 30000;\nexport const IFRAME_DEFAULT_HEIGHT = \"600px\"","// PayConductor Shared Types\n// Served statically at iframe.payconductor.ai/types.ts\n// Used by the iFrame (imported directly) and the SDK Web (synced with: bun sync)\n\nexport enum PaymentMethod {\n  Pix = \"Pix\",\n  CreditCard = \"CreditCard\",\n  DebitCard = \"DebitCard\",\n  BankSlip = \"BankSlip\",\n  Crypto = \"Crypto\",\n  ApplePay = \"ApplePay\",\n  NuPay = \"NuPay\",\n  PicPay = \"PicPay\",\n  AmazonPay = \"AmazonPay\",\n  SepaDebit = \"SepaDebit\",\n  GooglePay = \"GooglePay\",\n}\nexport enum PaymentMethodLayout {\n  Grid = \"grid\",\n  Vertical = \"vertical\",\n  Horizontal = \"horizontal\",\n}\nexport enum PaymentStatus {\n  Succeeded = \"succeeded\",\n  Pending = \"pending\",\n  Failed = \"failed\",\n}\nexport enum DeviceType {\n  Android = \"android\",\n  IOS = \"ios\",\n  Web = \"web\",\n}\nexport enum InputStyleKey {\n  Padding = \"padding\",\n  Radius = \"radius\",\n  Color = \"color\",\n  Background = \"background\",\n  Shadow = \"shadow\",\n}\nexport enum OutgoingMessage {\n  Init = \"Init\",\n  Config = \"Config\",\n  Update = \"Update\",\n  ConfirmPayment = \"ConfirmPayment\",\n  Validate = \"Validate\",\n  Reset = \"Reset\",\n}\nexport enum IncomingMessage {\n  Ready = \"Ready\",\n  Error = \"Error\",\n  PaymentComplete = \"PaymentComplete\",\n  PaymentFailed = \"PaymentFailed\",\n  PaymentPending = \"PaymentPending\",\n  ValidationError = \"ValidationError\",\n  PaymentMethodSelected = \"PaymentMethodSelected\",\n}\nexport enum ErrorCode {\n  InvalidClient = \"InvalidClient\",\n  InvalidToken = \"InvalidToken\",\n  NetworkError = \"NetworkError\",\n  IframeNotReady = \"IframeNotReady\",\n  PaymentDeclined = \"PaymentDeclined\",\n  ValidationError = \"ValidationError\",\n  Timeout = \"Timeout\",\n}\nexport type InputStyleConfig = {\n  padding?: string;\n  radius?: string;\n  color?: string;\n  background?: string;\n  shadow?: string;\n};\nexport type PaymentMethodsConfig = {\n  layout?: PaymentMethodLayout;\n  gap?: string;\n  inputStyle?: InputStyleConfig;\n};\nexport type PaymentMethodConfig = {\n  method: PaymentMethod;\n  discount?: number;\n  showBrands?: boolean;\n  installments?: {\n    count: number;\n    amount: number;\n  }[];\n};\nexport type PaymentMethodsResponse = {\n  methods: PaymentMethod[];\n  config: PaymentMethodsConfig;\n};\nexport type PayConductorTheme = {\n  primaryColor?: string;\n  secondaryColor?: string;\n  backgroundColor?: string;\n  surfaceColor?: string;\n  textColor?: string;\n  textSecondaryColor?: string;\n  errorColor?: string;\n  successColor?: string;\n  warningColor?: string;\n  borderColor?: string;\n  disabledColor?: string;\n  fontFamily?: string;\n  fontSize?: {\n    xs?: string;\n    sm?: string;\n    md?: string;\n    lg?: string;\n    xl?: string;\n  };\n  fontWeight?: {\n    normal?: number;\n    medium?: number;\n    bold?: number;\n  };\n  lineHeight?: string;\n  spacing?: {\n    xs?: string;\n    sm?: string;\n    md?: string;\n    lg?: string;\n    xl?: string;\n  };\n  borderRadius?: string;\n  borderWidth?: string;\n  boxShadow?: string;\n  boxShadowHover?: string;\n  inputBackground?: string;\n  inputBorderColor?: string;\n  inputBorderRadius?: string;\n  inputHeight?: string;\n  inputPadding?: string;\n  buttonHeight?: string;\n  buttonPadding?: string;\n  buttonBorderRadius?: string;\n  transitionDuration?: string;\n  transitionTimingFunction?: string;\n};\nexport const defaultTheme: PayConductorTheme = {\n  primaryColor: \"#0066ff\",\n  secondaryColor: \"#5a6b7c\",\n  backgroundColor: \"transparent\",\n  surfaceColor: \"#f8fafc\",\n  textColor: \"#0f172a\",\n  textSecondaryColor: \"#64748b\",\n  errorColor: \"#ef4444\",\n  successColor: \"#22c55e\",\n  warningColor: \"#f59e0b\",\n  borderColor: \"#e2e8f0\",\n  disabledColor: \"#cbd5e1\",\n  fontFamily: '\"Poppins\", -apple-system, BlinkMacSystemFont, \"Segoe UI\", sans-serif',\n  fontSize: {\n    xs: \"0.75rem\",\n    sm: \"0.875rem\",\n    md: \"1rem\",\n    lg: \"1.125rem\",\n    xl: \"1.25rem\"\n  },\n  fontWeight: {\n    normal: 400,\n    medium: 500,\n    bold: 600\n  },\n  lineHeight: \"1.5\",\n  spacing: {\n    xs: \"4px\",\n    sm: \"8px\",\n    md: \"16px\",\n    lg: \"24px\",\n    xl: \"32px\"\n  },\n  borderRadius: \"8px\",\n  borderWidth: \"1px\",\n  boxShadow: \"0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)\",\n  boxShadowHover: \"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)\",\n  inputBackground: \"#ffffff\",\n  inputBorderColor: \"#cbd5e1\",\n  inputBorderRadius: \"8px\",\n  inputHeight: \"44px\",\n  inputPadding: \"12px 16px\",\n  buttonHeight: \"48px\",\n  buttonPadding: \"16px 24px\",\n  buttonBorderRadius: \"8px\",\n  transitionDuration: \"0.2s\",\n  transitionTimingFunction: \"ease\"\n};\nexport type PayConductorConfig = {\n  publicKey: string;\n  orderId?: string;\n  theme?: PayConductorTheme;\n  locale?: string;\n  paymentMethods?: PaymentMethod[] | \"all\";\n  defaultPaymentMethod?: PaymentMethod;\n  paymentMethodsConfig?: PaymentMethodConfig[];\n  methodsDirection?: \"vertical\" | \"horizontal\";\n  showPaymentButtons?: boolean;\n  /** Required when NuPay is an available payment method */\n  nuPayConfig?: NuPayData;\n};\nexport type BillingDetails = {\n  name: string;\n  email?: string;\n  phone?: string;\n  address?: {\n    line1: string;\n    line2?: string;\n    city: string;\n    state: string;\n    postalCode: string;\n    country: string;\n  };\n};\nexport type CardData = {\n  number: string;\n  expMonth: string;\n  expYear: string;\n  cvc: string;\n};\nexport type CreatePaymentMethodOptions = {\n  billingDetails: BillingDetails;\n  card?: CardData;\n};\nexport type PaymentMethodResult = {\n  id: string;\n  type: PaymentMethod;\n  card?: {\n    brand: string;\n    last4: string;\n    expMonth: number;\n    expYear: number;\n  };\n  billingDetails?: BillingDetails;\n};\nexport type PaymentResult = {\n  orderId: string;\n  status: PaymentStatus;\n  amount: number;\n  currency: string;\n  message?: string;\n};\nexport interface MessagePayload {\n  type: OutgoingMessage | IncomingMessage;\n  data?: unknown;\n  requestId?: string;\n  error?: {\n    code: string;\n    message: string;\n    field?: string;\n  };\n}\nexport type CardTokenData = {\n  token: string;\n  firstSixCardNumber?: string;\n};\nexport type CardFullData = {\n  number: string;\n  holderName: string;\n  cvv: string;\n  expiration: {\n    month: number;\n    year: number;\n  };\n};\nexport type CardPaymentData = CardTokenData | CardFullData;\nexport type PixPaymentData = {\n  paymentMethod: PaymentMethod.Pix;\n  expirationInSeconds?: number;\n};\nexport type CreditCardPaymentData = {\n  paymentMethod: PaymentMethod.CreditCard;\n  card: CardPaymentData;\n  installments: number;\n  softDescriptor?: string;\n};\nexport type BankSlipPaymentData = {\n  paymentMethod: PaymentMethod.BankSlip;\n  expirationInDays?: number;\n};\nexport type NuPayData = {\n  cancelUrl: string;\n  merchantName: string;\n  returnUrl: string;\n  storeName?: string;\n};\nexport type NuPayPaymentData = {\n  paymentMethod: PaymentMethod.NuPay;\n  nuPay: NuPayData;\n};\nexport type PicPayPaymentData = {\n  paymentMethod: PaymentMethod.PicPay;\n};\nexport type PaymentConfirmData = PixPaymentData | CreditCardPaymentData | BankSlipPaymentData | NuPayPaymentData | PicPayPaymentData","import { IFRAME_BASE_URL_DEV, IFRAME_BASE_URL_PROD, IFRAME_DEFAULT_HEIGHT, REQUEST_TIMEOUT_MS } from \"./iframe/constants\";\nimport { IncomingMessage, OutgoingMessage } from \"./iframe/types\";\nconst isDev = typeof window !== \"undefined\" && (window.location.hostname === \"localhost\" || window.location.hostname === \"127.0.0.1\");\nexport const IFRAME_BASE_URL = isDev ? IFRAME_BASE_URL_DEV : IFRAME_BASE_URL_PROD;\nexport const ALLOWED_ORIGINS = [IFRAME_BASE_URL_DEV, IFRAME_BASE_URL_PROD];\nexport const IFRAME_DEFAULT_HEIGHT_VALUE = IFRAME_DEFAULT_HEIGHT;\nexport const REQUEST_TIMEOUT = REQUEST_TIMEOUT_MS;\nexport const POST_MESSAGES = {\n  INIT: OutgoingMessage.Init,\n  CONFIG: OutgoingMessage.Config,\n  UPDATE: OutgoingMessage.Update,\n  CONFIRM_PAYMENT: OutgoingMessage.ConfirmPayment,\n  VALIDATE: OutgoingMessage.Validate,\n  RESET: OutgoingMessage.Reset,\n  READY: IncomingMessage.Ready,\n  ERROR: IncomingMessage.Error,\n  PAYMENT_COMPLETE: IncomingMessage.PaymentComplete,\n  PAYMENT_FAILED: IncomingMessage.PaymentFailed,\n  PAYMENT_PENDING: IncomingMessage.PaymentPending,\n  VALIDATION_ERROR: IncomingMessage.ValidationError,\n  PAYMENT_METHOD_SELECTED: IncomingMessage.PaymentMethodSelected\n} as const;\nexport const ERROR_CODES = {\n  INVALID_CLIENT: \"InvalidClient\",\n  INVALID_TOKEN: \"InvalidToken\",\n  NETWORK_ERROR: \"NetworkError\",\n  IFRAME_NOT_READY: \"IframeNotReady\",\n  PAYMENT_DECLINED: \"PaymentDeclined\",\n  VALIDATION_ERROR: \"ValidationError\",\n  TIMEOUT: \"Timeout\"\n} as const","import { IFRAME_BASE_URL } from \"./constants\";\nimport type { PayConductorConfig } from \"./iframe/types\";\nexport function buildIframeUrl(config: PayConductorConfig): string {\n  const params = new URLSearchParams({\n    publicKey: config.publicKey\n  });\n  return `${IFRAME_BASE_URL}?${params.toString()}`;\n}\nexport function generateRequestId(): string {\n  return crypto.randomUUID();\n}\nexport function isValidOrigin(origin: string, allowedOrigins: string[]): boolean {\n  return allowedOrigins.includes(origin);\n}","import { ALLOWED_ORIGINS, POST_MESSAGES, REQUEST_TIMEOUT } from \"./constants\";\nimport { IncomingMessage, OutgoingMessage, PayConductorConfig, PaymentMethod, PaymentResult } from \"./iframe/types\";\nimport type { ConfirmPaymentOptions, PendingRequest } from \"./types\";\nimport { generateRequestId, isValidOrigin } from \"./utils\";\nexport function createPendingRequestsMap(): Map<string, PendingRequest> {\n  return new Map<string, PendingRequest>();\n}\nexport function sendMessageToIframe(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null, type: OutgoingMessage | IncomingMessage, data?: unknown): Promise<unknown> {\n  return new Promise((resolve, reject) => {\n    if (!iframe || !(\"contentWindow\" in iframe)) {\n      reject(new Error(\"Iframe not defined\"));\n      return;\n    }\n    if (!iframe?.contentWindow) {\n      reject(new Error(\"Iframe not ready\"));\n      return;\n    }\n    if (!pendingMap) {\n      reject(new Error(\"Pending requests not initialized\"));\n      return;\n    }\n    const requestId = generateRequestId();\n    pendingMap.set(requestId, {\n      resolve,\n      reject\n    });\n    iframe.contentWindow.postMessage({\n      type,\n      data,\n      requestId\n    }, \"*\");\n    setTimeout(() => {\n      if (pendingMap?.has(requestId)) {\n        pendingMap.delete(requestId);\n        reject(new Error(\"Request timeout\"));\n      }\n    }, REQUEST_TIMEOUT);\n  });\n}\nexport function confirmPayment(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null, options: ConfirmPaymentOptions): Promise<PaymentResult> {\n  return sendMessageToIframe(iframe, pendingMap, POST_MESSAGES.CONFIRM_PAYMENT, {\n    orderId: options.orderId\n  }) as Promise<PaymentResult>;\n}\nexport function validatePayment(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null, data: unknown): Promise<boolean> {\n  return sendMessageToIframe(iframe, pendingMap, POST_MESSAGES.VALIDATE, data) as Promise<boolean>;\n}\nexport function resetPayment(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null): Promise<void> {\n  return sendMessageToIframe(iframe, pendingMap, POST_MESSAGES.RESET) as Promise<void>;\n}\nexport function sendConfig(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null, config: Pick<PayConductorConfig, \"theme\" | \"locale\" | \"paymentMethods\" | \"defaultPaymentMethod\" | \"showPaymentButtons\" | \"nuPayConfig\">): Promise<void> {\n  return sendMessageToIframe(iframe, pendingMap, POST_MESSAGES.CONFIG, config) as Promise<void>;\n}\nexport function sendInit(iframe: HTMLIFrameElement | Element | undefined, pendingMap: Map<string, PendingRequest> | null, config: PayConductorConfig): Promise<void> {\n  return sendMessageToIframe(iframe, pendingMap, POST_MESSAGES.INIT, config) as Promise<void>;\n}\ntype MessagePayload = {\n  requestId?: string;\n  type?: string;\n  data?: PaymentResult | {\n    paymentMethod: PaymentMethod;\n  };\n  error?: {\n    message?: string;\n  };\n};\nexport function handleMessageEvent(event: MessageEvent, pendingMap: Map<string, PendingRequest> | null, setIsReady: (value: boolean) => void, setError: (value: string | null) => void, onReady?: () => void, onError?: (error: Error) => void, onPaymentComplete?: (data: PaymentResult) => void, onPaymentFailed?: (data: PaymentResult) => void, onPaymentPending?: (data: PaymentResult) => void, onPaymentMethodSelected?: (method: PaymentMethod) => void) {\n  if (!isValidOrigin(event.origin, ALLOWED_ORIGINS)) {\n    return;\n  }\n  const payload: MessagePayload = event.data;\n  const {\n    requestId,\n    type,\n    data,\n    error\n  } = payload;\n  if (requestId && pendingMap?.has(requestId)) {\n    const {\n      resolve,\n      reject\n    } = pendingMap.get(requestId)!;\n    pendingMap.delete(requestId);\n    if (error) {\n      reject(new Error(String(error.message)));\n    } else {\n      resolve(data);\n    }\n    return;\n  }\n  if (type === POST_MESSAGES.READY) {\n    setIsReady(true);\n    onReady?.();\n    return;\n  }\n  if (type === POST_MESSAGES.ERROR) {\n    setError(error?.message || \"Unknown error\");\n    onError?.(new Error(String(error?.message)));\n    return;\n  }\n  if (type === POST_MESSAGES.PAYMENT_COMPLETE) {\n    if (data && typeof data === \"object\" && \"status\" in data) {\n      onPaymentComplete?.(data);\n    }\n    return;\n  }\n  if (type === POST_MESSAGES.PAYMENT_FAILED) {\n    if (data && typeof data === \"object\" && \"status\" in data) {\n      onPaymentFailed?.(data);\n    }\n    return;\n  }\n  if (type === POST_MESSAGES.PAYMENT_PENDING) {\n    if (data && typeof data === \"object\" && \"status\" in data) {\n      onPaymentPending?.(data);\n    }\n    return;\n  }\n  if (type === POST_MESSAGES.PAYMENT_METHOD_SELECTED) {\n    if (data && typeof data === \"object\" && \"paymentMethod\" in data) {\n      onPaymentMethodSelected?.(data.paymentMethod);\n    }\n    return;\n  }\n}","\"use client\";\nimport * as React from \"react\";\nimport { useState, useEffect } from \"react\";\n\nexport interface PayConductorEmbedProps\n  extends Omit<PayConductorConfig, \"orderId\"> {\n  children?: any;\n  showActionButtons?: boolean;\n  debug?: boolean;\n  onReady?: () => void;\n  onError?: (error: Error) => void;\n  onPaymentComplete?: (result: PaymentResult) => void;\n  onPaymentFailed?: (result: PaymentResult) => void;\n  onPaymentPending?: (result: PaymentResult) => void;\n  onPaymentMethodSelected?: (method: PaymentMethod) => void;\n}\n\nimport type {\n  PayConductorConfig,\n  PaymentMethod,\n  PaymentResult,\n} from \"./iframe/types\";\nimport {\n  confirmPayment,\n  createPendingRequestsMap,\n  handleMessageEvent,\n  resetPayment,\n  sendConfig,\n  validatePayment,\n} from \"./internal\";\nimport type {\n  PayConductorApi,\n  PayConductorFrame,\n  PayConductorState,\n  PendingRequest,\n} from \"./types\";\nimport { buildIframeUrl } from \"./utils\";\n\nfunction PayConductor(props: PayConductorEmbedProps) {\n  const [isLoaded, setIsLoaded] = useState<PayConductorState[\"isLoaded\"]>(\n    () => false\n  );\n\n  const [isReady, setIsReady] = useState<PayConductorState[\"isReady\"]>(\n    () => false\n  );\n\n  const [error, setError] = useState<PayConductorState[\"error\"]>(() => null);\n\n  const [iframeUrl, setIframeUrl] = useState<PayConductorState[\"iframeUrl\"]>(\n    () => \"\"\n  );\n\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState<\n    PayConductorState[\"selectedPaymentMethod\"]\n  >(() => null);\n\n  useEffect(() => {\n    const log = (...args: any[]) => {\n      if (props.debug) {\n        console.log(\"[PayConductor]\", ...args);\n      }\n    };\n    log(\"SDK initializing\", {\n      publicKey: props.publicKey,\n    });\n    const iframeUrl = buildIframeUrl({\n      publicKey: props.publicKey,\n    });\n    setIframeUrl(iframeUrl);\n    setIsLoaded(true);\n    const pendingMap: Map<string, PendingRequest> = createPendingRequestsMap();\n    let configSent = false;\n    log(\"iframeUrl built:\", iframeUrl);\n    log(\"pendingMap created\");\n    const getIframe = (): HTMLIFrameElement | undefined => {\n      const ref = window.PayConductor?.frame?.iframe;\n      if (ref) {\n        if (ref instanceof HTMLIFrameElement) return ref;\n        if (typeof ref === \"object\" && ref !== null) {\n          if (\"current\" in ref) return (ref as any).current ?? undefined;\n          if (\"value\" in ref) return (ref as any).value ?? undefined;\n        }\n        return ref as HTMLIFrameElement;\n      }\n      return (\n        (document.querySelector(\n          \".payconductor-element iframe\"\n        ) as HTMLIFrameElement) ?? undefined\n      );\n    };\n    const frame: PayConductorFrame = {\n      iframe: null,\n      iframeUrl,\n      isReady: false,\n      error: null,\n    };\n    const config: PayConductorConfig = {\n      publicKey: props.publicKey,\n      theme: props.theme,\n      locale: props.locale,\n      paymentMethods: props.paymentMethods,\n      defaultPaymentMethod: props.defaultPaymentMethod,\n    };\n    const api: PayConductorApi = {\n      confirmPayment: (options: { orderId: string }) => {\n        log(\"confirmPayment called\", {\n          orderId: options.orderId,\n        });\n        return confirmPayment(getIframe(), pendingMap, options);\n      },\n      validate: (data: unknown) => {\n        log(\"validate called\", data);\n        return validatePayment(getIframe(), pendingMap, data);\n      },\n      reset: () => {\n        log(\"reset called\");\n        return resetPayment(getIframe(), pendingMap);\n      },\n      getSelectedPaymentMethod: () => selectedPaymentMethod,\n    };\n    window.PayConductor = {\n      frame,\n      config,\n      api,\n      selectedPaymentMethod: selectedPaymentMethod,\n    };\n    log(\"window.PayConductor registered\");\n    window.dispatchEvent(\n      new CustomEvent(\"payconductor:registered\", {\n        detail: window.PayConductor,\n      })\n    );\n    const sendConfigToIframe = async () => {\n      if (!configSent) {\n        const iframe = getIframe();\n        if (!iframe) {\n          log(\"sendConfigToIframe: iframe not found, skipping\");\n          return;\n        }\n        configSent = true;\n        log(\"sendConfig →\", {\n          theme: props.theme,\n          locale: props.locale,\n          paymentMethods: props.paymentMethods,\n          defaultPaymentMethod: props.defaultPaymentMethod,\n          showPaymentButtons: props.showPaymentButtons,\n        });\n        sendConfig(iframe, pendingMap, {\n          theme: props.theme,\n          locale: props.locale,\n          paymentMethods: props.paymentMethods,\n          defaultPaymentMethod: props.defaultPaymentMethod,\n          showPaymentButtons: props.showPaymentButtons,\n          nuPayConfig: props.nuPayConfig,\n        });\n      }\n    };\n    const eventHandler = (event: MessageEvent) => {\n      handleMessageEvent(\n        event,\n        pendingMap,\n        (val) => {\n          setIsReady(val);\n          frame.isReady = val;\n          if (window.PayConductor && window.PayConductor.frame)\n            window.PayConductor.frame.isReady = val;\n          if (val) {\n            log(\"iframe Ready — sending config\");\n            sendConfigToIframe();\n          }\n        },\n        (val) => {\n          setError(val);\n          frame.error = val;\n          if (window.PayConductor && window.PayConductor.frame)\n            window.PayConductor.frame.error = val;\n          log(\"iframe Error:\", val);\n        },\n        () => {\n          log(\"onReady fired\");\n          props.onReady?.();\n        },\n        (err) => {\n          log(\"onError fired:\", err);\n          props.onError?.(err);\n        },\n        (data) => {\n          log(\"PaymentComplete:\", data);\n          props.onPaymentComplete?.(data as PaymentResult);\n        },\n        (data) => {\n          log(\"PaymentFailed:\", data);\n          props.onPaymentFailed?.(data as PaymentResult);\n        },\n        (data) => {\n          log(\"PaymentPending:\", data);\n          props.onPaymentPending?.(data as PaymentResult);\n        },\n        (method) => {\n          log(\"PaymentMethodSelected:\", method);\n          setSelectedPaymentMethod(method);\n          if (window.PayConductor) {\n            window.PayConductor.selectedPaymentMethod = method;\n          }\n          props.onPaymentMethodSelected?.(method);\n        }\n      );\n    };\n    window.addEventListener(\"message\", eventHandler);\n    log(\"SDK initialized — waiting for PayConductorCheckoutElement\");\n  }, []);\n\n  return (\n    <div\n      className=\"payconductor\"\n      id=\"payconductor\"\n      style={{\n        display: \"contents\",\n      }}\n    >\n      {props.children}\n    </div>\n  );\n}\n\nexport default PayConductor;\n","\"use client\";\nimport * as React from \"react\";\nimport { useState, useRef, useEffect } from \"react\";\n\nexport interface PayConductorCheckoutElementProps {\n  height?: string;\n}\n\nimport { IFRAME_DEFAULT_HEIGHT_VALUE } from \"./constants\";\n\nfunction PayConductorCheckoutElement(props: PayConductorCheckoutElementProps) {\n  const iframeRef = useRef<any>(null);\n  const [iframeUrl, setIframeUrl] = useState(() => \"\");\n\n  const [isLoaded, setIsLoaded] = useState(() => false);\n\n  useEffect(() => {\n    const init = (ctx: typeof window.PayConductor) => {\n      if (!ctx?.frame) return;\n      setIframeUrl(ctx.frame.iframeUrl || \"\");\n      ctx.frame.iframe = iframeRef.current;\n      console.log(\n        \"[PayConductorCheckoutElement] iframe registered, src:\",\n        iframeUrl\n      );\n      setIsLoaded(true);\n    };\n    const ctx = typeof window !== \"undefined\" ? window.PayConductor : null;\n    if (ctx) {\n      init(ctx);\n    } else {\n      const handler = (e: Event) => {\n        init((e as CustomEvent).detail);\n        window.removeEventListener(\"payconductor:registered\", handler);\n      };\n      window.addEventListener(\"payconductor:registered\", handler);\n    }\n  }, []);\n\n  return (\n    <div\n      className=\"payconductor-element\"\n      style={{\n        width: \"100%\",\n      }}\n    >\n      {isLoaded && iframeUrl ? (\n        <iframe\n          allow=\"payment\"\n          title=\"PayConductor\"\n          ref={iframeRef}\n          src={iframeUrl}\n          style={{\n            width: \"100%\",\n            height: props.height || IFRAME_DEFAULT_HEIGHT_VALUE,\n            border: \"none\",\n          }}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nexport default PayConductorCheckoutElement;\n","import type { PayConductorConfig } from \"../iframe/types\";\nimport type { PayConductorFrame } from \"../types\";\ntype UsePayConductorReturn = PayConductorFrame & Partial<PayConductorConfig>;\nexport function usePayConductor(): UsePayConductorReturn {\n  const ctx = typeof window !== \"undefined\" ? window.PayConductor : null;\n  const config = ctx?.config ? {\n    publicKey: ctx.config.publicKey,\n    orderId: ctx.config.orderId,\n    theme: ctx.config.theme,\n    locale: ctx.config.locale\n  } : {};\n  const frame = ctx?.frame ? {\n    iframe: ctx.frame.iframe,\n    isReady: ctx.frame.isReady,\n    error: ctx.frame.error\n  } : {\n    iframe: null,\n    isReady: false,\n    error: null\n  };\n  return {\n    ...config,\n    ...frame\n  };\n}","import { POST_MESSAGES } from \"../constants\";\nimport type { BillingDetails, PayConductorConfig, PaymentMethod, PaymentResult } from \"../iframe/types\";\nimport { confirmPayment, createPendingRequestsMap, sendInit, sendMessageToIframe } from \"../internal\";\nexport type SubmitResult = {\n  error?: {\n    message: string;\n    code?: string;\n    type?: \"validation_error\" | \"payment_error\";\n  };\n  paymentMethod?: PaymentMethod;\n};\nexport type ConfirmPaymentOptions = {\n  orderId: string;\n  returnUrl?: string;\n};\nexport type UpdateOptions = {\n  billingDetails?: Partial<BillingDetails>;\n  address?: Partial<BillingDetails[\"address\"]>;\n};\nexport interface UsePayconductorElementReturn {\n  init: (config: PayConductorConfig) => Promise<void>;\n  confirmPayment: (options: ConfirmPaymentOptions) => Promise<PaymentResult>;\n  validate: (data: unknown) => Promise<boolean>;\n  reset: () => Promise<void>;\n  getSelectedPaymentMethod: () => PaymentMethod | null;\n  updateConfig: (config: Partial<Pick<PayConductorConfig, \"theme\" | \"locale\" | \"paymentMethods\">>) => void;\n  updateorderId: (orderId: string) => void;\n  update: (options: UpdateOptions) => void;\n  submit: () => Promise<SubmitResult>;\n}\nfunction getIframeFromContext(ctx: typeof window.PayConductor): HTMLIFrameElement | null {\n  if (ctx?.frame?.iframe) {\n    const iframeRef = ctx.frame.iframe;\n    if (iframeRef instanceof HTMLIFrameElement) return iframeRef;\n    if (iframeRef && typeof iframeRef === \"object\") {\n      if (\"current\" in iframeRef) {\n        const el = (iframeRef as any).current;\n        if (el instanceof HTMLIFrameElement) return el;\n      }\n      if (\"value\" in iframeRef) {\n        const el = (iframeRef as any).value;\n        if (el instanceof HTMLIFrameElement) return el;\n      }\n    }\n  }\n  return document.querySelector(\".payconductor-element iframe\") as HTMLIFrameElement ?? null;\n}\nexport function usePayconductorElement(): UsePayconductorElementReturn {\n  const getCtx = () => typeof window !== \"undefined\" ? window.PayConductor : null;\n  const sendToIframe = (type: string, data?: unknown) => {\n    const ctx = getCtx();\n    if (!ctx) return;\n    const iframe = getIframeFromContext(ctx);\n    if (iframe?.contentWindow) {\n      iframe.contentWindow.postMessage({\n        type,\n        data\n      }, \"*\");\n    }\n  };\n  return {\n    init: async (config: PayConductorConfig): Promise<void> => {\n      const iframe = getIframeFromContext(getCtx());\n      const pendingMap = createPendingRequestsMap();\n      return sendInit(iframe || undefined, pendingMap, config);\n    },\n    confirmPayment: async (options: ConfirmPaymentOptions): Promise<PaymentResult> => {\n      const iframe = getIframeFromContext(getCtx());\n      const pendingMap = createPendingRequestsMap();\n      if (!options.orderId) {\n        throw new Error(\"Order ID is required\");\n      }\n      return confirmPayment(iframe || undefined, pendingMap, options);\n    },\n    validate: (data: unknown) => {\n      const ctx = getCtx();\n      if (!ctx) return Promise.resolve(false);\n      return ctx.api.validate(data);\n    },\n    reset: () => {\n      const ctx = getCtx();\n      if (!ctx) return Promise.resolve();\n      return ctx.api.reset();\n    },\n    getSelectedPaymentMethod: (): PaymentMethod | null => {\n      return getCtx()?.selectedPaymentMethod ?? null;\n    },\n    updateConfig: (config: Partial<Pick<PayConductorConfig, \"theme\" | \"locale\" | \"paymentMethods\">>) => {\n      const currentConfig = getCtx()?.config;\n      sendToIframe(POST_MESSAGES.CONFIG, {\n        publicKey: currentConfig?.publicKey,\n        orderId: currentConfig?.orderId,\n        theme: config.theme ?? currentConfig?.theme,\n        locale: config.locale ?? currentConfig?.locale,\n        paymentMethods: config.paymentMethods ?? currentConfig?.paymentMethods\n      });\n    },\n    updateorderId: (orderId: string) => {\n      const currentConfig = getCtx()?.config;\n      sendToIframe(POST_MESSAGES.CONFIG, {\n        publicKey: currentConfig?.publicKey,\n        orderId: orderId,\n        theme: currentConfig?.theme,\n        locale: currentConfig?.locale,\n        paymentMethods: currentConfig?.paymentMethods\n      });\n    },\n    update: (options: UpdateOptions) => {\n      sendToIframe(POST_MESSAGES.UPDATE, options);\n    },\n    submit: async (): Promise<SubmitResult> => {\n      const iframe = getIframeFromContext(getCtx());\n      const pendingMap = createPendingRequestsMap();\n      try {\n        await sendMessageToIframe(iframe || undefined, pendingMap, POST_MESSAGES.CONFIRM_PAYMENT, {});\n        return {\n          paymentMethod: undefined\n        };\n      } catch (error) {\n        const message = error instanceof Error ? error.message : \"Payment failed\";\n        return {\n          error: {\n            message,\n            code: \"payment_error\",\n            type: \"payment_error\"\n          }\n        };\n      }\n    }\n  };\n}"],"names":["IFRAME_BASE_URL_PROD","IFRAME_BASE_URL_DEV","REQUEST_TIMEOUT_MS","IFRAME_DEFAULT_HEIGHT","OutgoingMessage","IncomingMessage","isDev","IFRAME_BASE_URL","ALLOWED_ORIGINS","IFRAME_DEFAULT_HEIGHT_VALUE","REQUEST_TIMEOUT","POST_MESSAGES","ERROR_CODES","buildIframeUrl","config","params","generateRequestId","isValidOrigin","origin","allowedOrigins","createPendingRequestsMap","sendMessageToIframe","iframe","pendingMap","type","data","resolve","reject","requestId","confirmPayment","options","validatePayment","resetPayment","sendConfig","sendInit","handleMessageEvent","event","setIsReady","setError","onReady","onError","onPaymentComplete","onPaymentFailed","onPaymentPending","onPaymentMethodSelected","payload","error","PayConductor","props","isLoaded","setIsLoaded","useState","isReady","iframeUrl","setIframeUrl","selectedPaymentMethod","setSelectedPaymentMethod","useEffect","log","args","configSent","getIframe","ref","_b","_a","frame","api","sendConfigToIframe","eventHandler","val","err","method","jsx","PayConductorCheckoutElement","iframeRef","useRef","init","ctx","handler","e","usePayConductor","getIframeFromContext","el","usePayconductorElement","getCtx","sendToIframe","currentConfig","orderId"],"mappings":"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"}